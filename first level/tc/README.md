[Вернуться к оглавлению](https://github.com/engine-it-in/different-level-task/blob/main/README.md)
***
* [Test Containers](#test-containers)
  * [Кейс для тестирования](#кейс-для-тестирования)
    * [Решение с JUnit5](#решение-с-junit5)
    * [Решение с JUnit4](#решение-с-junit4)
***

# Test Containers

Инструмент тестирования, позволяющий поднимать контейнеры во время исполнения теста. Полезен при интеграционных тестах (
к примеру, БД).
Можно использовать как с JUnit4, так и с JUnit5.

## Кейс для тестирования
Существует БД с JPA репозиторием, работу которого следует проверить. Проверке подвергаем метод create, создающий запись
в БД.

### Решение с JUnit5

* Пометить класс аннотацией `@Testcontainers`;
* Добавить поле контейнера требуемого типа (статическое - будет подниматься в начале первого теста и останавливаться в
  конце последнего теста, иначе - будет подниматься/останавливаться в начале/конце каждого теста соответственно).
* Инициализировать контекст с помощью статического класса ApplicationContextInitializer, передать свойства, необходимые
  для работы с datasource.
* В тестах использовать репозиторий и проверять его работу с помощью прямых селектов к БД.

### Решение с JUnit4

* Добавить @ClassRule над полем контейнера требуемого типа;
* Инициализировать контекст с помощью статического класса ApplicationContextInitializer, передать свойства, необходимые
  для работы с datasource.
* В тестах использовать репозиторий и проверять его работу с помощью прямых селектов к БД.

Статьи:
https://www.baeldung.com/spring-boot-testcontainers-integration-test
https://www.testcontainers.org/test_framework_integration/junit_5/