<!-- TOC -->
* [Java memory](#java-memory)
  * [Concepts](#concepts)
  * [Recommendations](#recommendations)
  * [Garbage Collector](#garbage-collector)
<!-- TOC -->

# Java memory

В Java управление памятью полностью осуществляется сборщиком мусора.

## Concepts

- Объекты в Java создаются с использованием оператора `new`. Память для объектов выделяется в куче (heap memory).
- Каждый объект должен быть явно освобожден с помощью сборщика мусора, когда он становится недоступным. Нет
  необходимости вручную удалять объекты;
- Классы в Java создаются в области памяти, называемой метод-область (method area), и каждый класс имеет только один
  экземпляр в памяти;

## Recommendations

Ниже приведены несколько практических рекомендаций для работы с памятью в Java:

- Избегать создания ненужных объектов, особенно в циклах, чтобы избежать перенаполнения кучи;
- Использовать локальные переменные, когда это возможно, вместо полей объектов. Локальные переменные освобождаются сразу
  после их использования, в то время как поля объектов могут существовать дольше, даже если они больше не нужны.
- Обнулять ссылки на объекты, когда они больше не используются. Это позволит сборщику мусора освободить память быстрее.
- Использовать `try-with-resources` (начиная с Java 7) для автоматического закрытия ресурсов (файлы или сетевые
  соединения), после их использования. Это гарантирует правильное освобождение памяти.
- Использовать потоковые (`stream`) операций, которые позволяют обрабатывать данные кусками и занимают минимум памяти.
- Увеличение объема памяти для JVM регулируется параметром -Xmx (например, -Xmx4g означает 4 гигабайта памяти).

## Garbage Collector

Сборщик мусора в Java автоматически управляет памятью и освобождает объекты, которые больше не используются в программе.
Он работает в фоновом режиме и предоставляет следующие шаги для освобождения памяти:

- Маркировка: Сборщик мусора начинает с корневых объектов (которые обычно являются статическими переменными или ссылками
  на объекты в потоках выполнения) и маркирует все доступные объекты, которые достижимы из корневых объектов.
- Определение: Сборщик мусора определяет, какие объекты не могут быть достигнуты из корневых объектов и помечает их для
  удаления.
- Очистка: Помеченные объекты удаляются из памяти, и их пространство освобождается для будущего использования.

Сборщик мусора в Java использует алгоритм, называемый "поколениями". Он делит все объекты на несколько поколений на
основе их времени жизни. Новые объекты помещаются в "молодое поколение" (young generation), где сборка мусора происходит
достаточно часто. Если объекты выживают достаточно долго, они перемещаются в "старое поколение" (old generation), где
сборка мусора выполняется реже.

Кроме того, Java также предоставляет возможность вручную вызывать сборку мусора с помощью метода System.gc(). Однако
рекомендуется довериться автоматическому сборщику мусора Java, который обычно эффективно управляет памятью без
необходимости вручную вызывать сборку мусора.
